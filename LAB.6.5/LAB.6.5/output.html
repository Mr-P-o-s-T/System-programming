<!DOCTYPE html>
<html>

<head>
<title>input.f</title>
<link rel="stylesheet" href="dtb\css.css">
</head>

<body>
<pre>
	<span class="reserved">SUBROUTINE</span> <span class="id">CONVCASE</span><span class="operator">(</span><span class="id">CIN</span><span class="operator">,</span> <span class="id">COUT</span><span class="operator">,</span> <span class="id">LEN</span><span class="operator">,</span> <span class="id">UPCASE</span><span class="operator">)</span>
	<span class="reserved">IMPLICIT</span> <span class="reserved">NONE</span><span class="operator">;</span>
	<span class="reserved">INTEGER</span> <span class="operator">::</span> <span class="id">LEN</span><span class="operator">;</span>
	<span class="reserved">CHARACTER</span> <span class="operator">(</span><span class="id">LEN</span> <span class="operator">=</span> <span class="operator">*</span><span class="operator">)</span> <span class="operator">::</span> <span class="id">CIN</span><span class="operator">,</span> <span class="id">COUT</span><span class="operator">;</span>
	<span class="reserved">LOGICAL</span> <span class="operator">::</span> <span class="id">UPCASE</span><span class="operator">;</span>
<span class="comment">!</span>
<span class="comment">! 1) CONVERT A CHARACTER STRING TO ALL UPPER CASE OR ALL</span>
<span class="comment">! LOWERCASE.</span>
<span class="comment">! 2) ARGUMENTS:</span>
<span class="comment">!</span>
<span class="comment">! CIN = INPUT CHARACTER STRING</span>
<span class="comment">! COUT = OUTPUT CHARACTER STRING IN CONVERTED CASE</span>
<span class="comment">! LEN = THE CHARACTER LENGTH OF CIN</span>
<span class="comment">! UPCASE = CASE CONVERSION FLAG</span>
<span class="comment">! = .TRUE. FOR UPPER CASE</span>
<span class="comment">! = .FALSE. FOR LOWER CASE</span>
<span class="comment">!</span>
	<span class="reserved">INTEGER</span> <span class="operator">::</span> <span class="id">I</span><span class="operator">,</span> <span class="id">ILETTR</span><span class="operator">,</span> <span class="id">ILOWRO</span><span class="operator">,</span> <span class="id">IUPPRO</span><span class="operator">;</span>
	<span class="reserved">LOGICAL</span> <span class="operator">::</span> <span class="id">BOOLEAN</span> <span class="operator">=</span> <span class="logicalConst">.true.</span> <span class="logicalOperator">.not.</span> <span class="logicalConst">.FAlsE.</span>
	<span class="id">IUPPRO</span> <span class="operator">=</span> <span class="id">IACHAR</span><span class="operator">(</span><span class="string">'A'</span><span class="operator">)</span> <span class="operator">-</span> <span class="operator">+</span><span class="number">1.E-1</span><span class="operator">;</span> 
	<span class="id">ILOWRO</span> <span class="operator">=</span> <span class="id">IACHAR</span><span class="operator">(</span><span class="string">'a'</span><span class="operator">)</span> <span class="operator">-</span> <span class="operator">+</span> <span class="number">1_n1</span><span class="operator">;</span>
	
	<span class="id">COUT</span> <span class="operator">=</span> <span class="string">''</span><span class="operator">;</span>
	<span class="reserved">IF</span><span class="operator">(</span><span class="id">UPCASE</span><span class="operator">)</span> <span class="reserved">THEN</span>
		<span class="reserved">DO</span> <span class="id">I</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">,</span> <span class="id">LEN</span>
			<span class="id">ILETTR</span> <span class="operator">=</span> <span class="id">IACHAR</span><span class="operator">(</span><span class="id">CIN</span><span class="operator">(</span><span class="id">I</span><span class="operator">:</span><span class="id">I</span><span class="operator">)</span><span class="operator">)</span> <span class="operator">-</span> <span class="id">ILOWRO</span><span class="operator">;</span>
			<span class="reserved">IF</span><span class="operator">(</span><span class="id">ILETTR</span> <span class="logicalOperator">.GE.</span> <span class="number">1</span> <span class="error">.AND</span> <span class="id">ILETTR</span> <span class="logicalOperator">.LE.</span> <span class="number">26</span><span class="operator">)</span> <span class="reserved">THEN</span>	<span class="comment">! CONVERT TO UPPER CASE.</span>
				<span class="id">COUT</span><span class="operator">(</span><span class="id">I</span><span class="operator">:</span><span class="id">I</span><span class="operator">)</span> <span class="operator">=</span> <span class="id">ACHAR</span><span class="operator">(</span><span class="id">IUPPRO</span> <span class="operator">+</span> <span class="id">ILETTR</span><span class="operator">)</span><span class="operator">;</span>
			<span class="reserved">ELSE</span>
				<span class="id">COUT</span><span class="operator">(</span><span class="id">I</span><span class="operator">:</span><span class="id">I</span><span class="operator">)</span> <span class="operator">=</span><span class="operator">;</span>
			<span class="reserved">END</span> <span class="reserved">IF</span>
		<span class="reserved">END</span> <span class="reserved">DO</span>
	<span class="reserved">ELSE</span>
		<span class="reserved">DO</span> <span class="id">I</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">,</span> <span class="id">LEN</span>
			<span class="id">ILETTR</span> <span class="operator">=</span> <span class="id">IACHAR</span><span class="operator">(</span><span class="id">CIN</span><span class="operator">(</span><span class="id">I</span><span class="operator">:</span><span class="id">I</span><span class="operator">)</span><span class="operator">)</span> <span class="operator">-</span> <span class="id">IUPPRO</span><span class="operator">;</span>
			<span class="reserved">IF</span> <span class="operator">(</span><span class="id">ILETTR</span> <span class="logicalOperator">.GE.</span> <span class="number">1</span> <span class="logicalOperator">.AND.</span> <span class="id">ILETTR</span> <span class="logicalOperator">.LE.</span> <span class="number">26</span><span class="operator">)</span> <span class="reserved">THEN</span>	<span class="comment">! CONVERT TO UPPER CASE.</span>
				<span class="id">COUT</span><span class="operator">(</span><span class="id">I</span><span class="operator">:</span><span class="id">I</span><span class="operator">)</span> <span class="operator">=</span> <span class="id">ACHAR</span><span class="operator">(</span><span class="id">ILOWR0</span> <span class="operator">+</span> <span class="id">ILETTR</span><span class="operator">)</span><span class="operator">;</span>
			<span class="reserved">ELSE</span>
				<span class="id">COUT</span><span class="operator">(</span><span class="id">I</span><span class="operator">:</span><span class="id">I</span><span class="operator">)</span> <span class="operator">=</span> <span class="id">CIN</span><span class="operator">(</span><span class="id">I</span><span class="operator">:</span><span class="id">I</span><span class="operator">)</span><span class="operator">;</span>
			<span class="reserved">END</span> <span class="reserved">IF</span>
		<span class="reserved">END</span> <span class="reserved">DO</span>
	<span class="reserved">END</span> <span class="reserved">IF</span>
<span class="reserved">END</span> <span class="reserved">SUBROUTINE</span> <span class="id">CONVCASE</span>
</pre>
</body>

</html>